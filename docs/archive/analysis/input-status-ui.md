# StreamLive 입력 상태 확인 UI 가이드

## 개요

StreamLive 채널이 운영 중일 때, main/backup 입력 중 어느 신호로 우선 서비스되고 있는지 확인할 수 있는 기능입니다.

## UI 동작 방식

### 1. 대시보드에서 정보 확인

#### 1.1 대시보드 열기
- 슬랙에서 `/tencent` 명령어 입력
- 또는 봇 멘션 후 대시보드 요청

#### 1.2 채널 목록 확인
대시보드 모달에서 StreamLive 채널들이 다음과 같이 표시됩니다:

```
┌─────────────────────────────────────────┐
│  Tencent Media Dashboard                 │
├─────────────────────────────────────────┤
│  [채널] [스케줄]                        │
├─────────────────────────────────────────┤
│  서비스: [전체 ▼]  상태: [전체 ▼]      │
│  검색: [채널명 검색...]                 │
├─────────────────────────────────────────┤
│  📊 전체 10개 | 🟢 실행 5 | 🔴 중지 3  │
├─────────────────────────────────────────┤
│  🟢 📺 *My StreamLive Channel*          │
│  ID: `channel-123` | 상태: running      │
│  [▶️ 시작] [🔗 통합 시작] [ℹ️]        │
│  └ 🟢 🔗 *Linked StreamLink Flow*      │
│     상태: running  [▶️ 시작]            │
├─────────────────────────────────────────┤
│  [새로고침]                             │
└─────────────────────────────────────────┘
```

### 2. 입력 상태 확인하기

#### 2.1 정보 버튼 클릭
StreamLive 채널의 **ℹ️ (정보)** 버튼을 클릭합니다.

#### 2.2 입력 상태 표시
정보가 슬랙 채널에 다음과 같이 표시됩니다:

**케이스 1: Main 입력이 활성화된 경우**
```
┌─────────────────────────────────────────┐
│  *My StreamLive Channel*                 │
│  ID: `channel-123`                       │
│  서비스: StreamLive                      │
│  상태: running                           │
│                                          │
│  🟢 *입력 상태*: MAIN                   │
│     (main-input-001)                    │
└─────────────────────────────────────────┘
```

**케이스 2: Backup 입력이 활성화된 경우**
```
┌─────────────────────────────────────────┐
│  *My StreamLive Channel*                 │
│  ID: `channel-123`                       │
│  서비스: StreamLive                      │
│  상태: running                           │
│                                          │
│  ⚠️ *입력 상태*: BACKUP                 │
│     (backup-input-002)                  │
└─────────────────────────────────────────┘
```

**케이스 3: 입력 상태 확인 불가능한 경우**
```
┌─────────────────────────────────────────┐
│  *My StreamLive Channel*                 │
│  ID: `channel-123`                       │
│  서비스: StreamLive                      │
│  상태: running                           │
│                                          │
│  ❓ *입력 상태*: 확인 불가               │
└─────────────────────────────────────────┘
```

## UI 요소 설명

### 이모지 표시 규칙

| 이모지 | 의미 | 설명 |
|--------|------|------|
| 🟢 | Main 입력 활성 | 정상적으로 main 입력이 사용 중 |
| ⚠️ | Backup 입력 활성 | Failover 발생, backup 입력 사용 중 |
| ❓ | 상태 확인 불가 | API 오류 또는 입력 정보 없음 |

### 표시되는 정보

1. **채널 이름**: StreamLive 채널의 이름
2. **채널 ID**: Tencent Cloud의 채널 식별자
3. **서비스 타입**: StreamLive
4. **채널 상태**: running, stopped, idle, error 등
5. **입력 상태**: MAIN 또는 BACKUP
6. **활성 입력 이름**: 현재 사용 중인 입력의 이름 (있는 경우)

## 사용 시나리오

### 시나리오 1: 정상 운영 확인
1. 대시보드에서 실행 중인 StreamLive 채널 찾기
2. ℹ️ 버튼 클릭
3. "🟢 입력 상태: MAIN" 확인 → 정상

### 시나리오 2: Failover 확인
1. 대시보드에서 실행 중인 StreamLive 채널 찾기
2. ℹ️ 버튼 클릭
3. "⚠️ 입력 상태: BACKUP" 확인 → Failover 발생
4. Main 입력 문제 확인 필요

### 시나리오 3: 여러 채널 일괄 확인
1. 대시보드에서 여러 StreamLive 채널 확인
2. 각 채널의 ℹ️ 버튼 클릭하여 입력 상태 확인
3. Backup 입력 사용 중인 채널 식별

## 제한사항

1. **실행 중인 채널만 확인 가능**
   - 중지된 채널에서는 입력 상태를 확인할 수 없습니다
   - 채널이 실행 중(running)일 때만 입력 상태가 표시됩니다

2. **API 응답 시간**
   - 입력 상태 확인을 위해 추가 API 호출이 필요합니다
   - 네트워크 상태에 따라 1-3초 정도 소요될 수 있습니다

3. **입력이 없는 채널**
   - 연결된 입력이 없는 채널은 "연결된 입력이 없습니다" 메시지가 표시됩니다

## 기술적 세부사항

### 확인 방법
1. **QueryInputStreamState API**: 각 입력의 활성 상태 확인
2. **DescribeStreamLiveChannelInputStatistics API**: 대역폭 기반 대체 확인
3. **FailOverSettings**: Primary/Secondary 입력 관계 확인

### 판단 로직
- Primary 입력이 활성화되어 있으면 → MAIN
- Secondary 입력이 활성화되어 있으면 → BACKUP
- 둘 다 비활성화이거나 확인 불가 → 상태 확인 불가

## 예제 스크린샷 설명

### 대시보드 화면
```
┌─────────────────────────────────────────────┐
│  Tencent Media Dashboard                    │
├─────────────────────────────────────────────┤
│  [채널*] [스케줄]                          │
├─────────────────────────────────────────────┤
│  서비스: [전체 서비스 ▼]                    │
│  상태: [전체 상태 ▼]                        │
│  검색: [채널명 검색...]                     │
├─────────────────────────────────────────────┤
│  📊 전체 3개 | 🟢 실행 2 | 🔴 중지 1        │
├─────────────────────────────────────────────┤
│                                             │
│  🟢 📺 *Production Channel*                 │
│  ID: `prod-channel-001` | 상태: running     │
│  [▶️ 시작] [🔗 통합 시작] [ℹ️]             │
│                                             │
│  └ 🟢 🔗 *StreamLink Flow 1*               │
│     상태: running  [▶️ 시작]                │
│                                             │
│  └ 🟢 🔗 *StreamLink Flow 2*               │
│     상태: running  [▶️ 시작]                │
│                                             │
├─────────────────────────────────────────────┤
│  🟢 📺 *Backup Channel*                    │
│  ID: `backup-channel-002` | 상태: running  │
│  [▶️ 시작] [🔗 통합 시작] [ℹ️]             │
│                                             │
├─────────────────────────────────────────────┤
│  [새로고침]                                 │
└─────────────────────────────────────────────┘
```

### 정보 확인 결과 (Main 입력 활성)
```
[Ephemeral Message - Only you can see this]

┌─────────────────────────────────────────────┐
│  *Production Channel*                       │
│  ID: `prod-channel-001`                      │
│  서비스: StreamLive                          │
│  상태: running                               │
│                                              │
│  🟢 *입력 상태*: MAIN                       │
│     (Primary Input - Main Signal)           │
└─────────────────────────────────────────────┘
```

### 정보 확인 결과 (Backup 입력 활성)
```
[Ephemeral Message - Only you can see this]

┌─────────────────────────────────────────────┐
│  *Production Channel*                       │
│  ID: `prod-channel-001`                      │
│  서비스: StreamLive                          │
│  상태: running                               │
│                                              │
│  ⚠️ *입력 상태*: BACKUP                     │
│     (Secondary Input - Backup Signal)       │
│                                              │
│  ⚠️ 주의: Main 입력에 문제가 있어          │
│     Backup 입력으로 전환되었습니다.         │
└─────────────────────────────────────────────┘
```

## FAQ

**Q: 입력 상태가 항상 표시되나요?**  
A: 아니요. StreamLive 채널이고 실행 중일 때만 표시됩니다.

**Q: Main과 Backup을 어떻게 구분하나요?**  
A: Tencent Cloud의 FailOverSettings에서 Primary 입력을 Main, Secondary 입력을 Backup으로 구분합니다.

**Q: 입력 상태 확인이 실패하면?**  
A: 기본 채널 정보는 표시되지만, 입력 상태는 "확인 불가"로 표시됩니다.

**Q: 여러 입력이 있을 때는?**  
A: 현재 활성화된 입력만 표시됩니다. Primary가 활성화되면 MAIN, Secondary가 활성화되면 BACKUP으로 표시됩니다.

## 관련 문서

- [Tencent Cloud StreamLive API 문서](https://www.tencentcloud.com/document/product/1048)
- [대시보드 사용 가이드](./architecture.md)
- [슬랙 봇 설정 가이드](./setup.md)
